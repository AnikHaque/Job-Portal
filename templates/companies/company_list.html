{% extends "base.html" %}
{% block content %}

<section class="py-5">
  <div class="container">
    <div class="row">

      <!-- ================= LEFT SIDEBAR ================= -->
      <div class="col-lg-3">
        <form method="get" action="{% url 'company_list' %}" class="card p-3">

          <h5 class="mb-3">Filter Companies</h5>

          <!-- Keyword -->
          <div class="mb-3">
            <label class="form-label">Keyword</label>
            <input type="text"
                   name="q"
                   class="form-control"
                   placeholder="Company name"
                   value="{{ keyword|default_if_none:'' }}">
          </div>

          <!-- Location -->
          <div class="mb-3">
            <label class="form-label">Location</label>
            <input type="text"
                   name="location"
                   class="form-control"
                   placeholder="City"
                   value="{{ location|default_if_none:'' }}">
          </div>

          <button class="btn btn-primary w-100">
            Apply Filters
          </button>

          {% if request.GET %}
          <a href="{% url 'company_list' %}"
             class="btn btn-outline-secondary w-100 mt-2">
            Clear Filters
          </a>
          {% endif %}

        </form>
      </div>

      <!-- ================= COMPANY LIST ================= -->
      <div class="col-lg-9">
        <div class="row g-4">

          {% for company in companies %}
          <div class="col-md-6 col-xl-4">
            <div class="card h-100 p-3">

              <div class="text-center mb-3">
                {% if company.logo %}
                  <img src="{{ company.logo.url }}"
                       class="img-fluid"
                       style="max-height:60px">
                {% endif %}
              </div>

              <h5 class="text-center">{{ company.name }}</h5>

              <p class="text-muted small text-center">
                {{ company.location }}
              </p>

              <p class="small">
                {{ company.description|truncatewords:15 }}
              </p>

              <div class="text-center mb-3">
                <span class="badge bg-primary">
                  {{ company.total_jobs }} Jobs
                </span>
              </div>

              <a href="{% url 'company_public_detail' company.id %}"
                 class="btn btn-outline-primary w-100">
                View Company
              </a>

            </div>
          </div>
          {% empty %}
            <p class="text-center text-muted">
              No companies found.
            </p>
          {% endfor %}

        </div>
      </div>

    </div>
  </div>
</section>

{% endblock %}
